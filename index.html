<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edouard Legoupil, Chief Data Officer, IOM">
<meta name="dcterms.date" content="2025-04-04">

<title>Using AI to draft Project Proposal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-0626ff4d7a71b55c8707dcae1d04a9b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-e32a626c8e9c95d1b95290327a4672e3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#environment-set-up" id="toc-environment-set-up" class="nav-link" data-scroll-target="#environment-set-up">Environment Set up</a></li>
  <li><a href="#setting-up-llm-api" id="toc-setting-up-llm-api" class="nav-link" data-scroll-target="#setting-up-llm-api">Setting up LLM API</a>
  <ul class="collapse">
  <li><a href="#using-azure-open-ai" id="toc-using-azure-open-ai" class="nav-link" data-scroll-target="#using-azure-open-ai">Using Azure Open AI</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#first-iteration" id="toc-first-iteration" class="nav-link" data-scroll-target="#first-iteration">First Iteration</a>
  <ul class="collapse">
  <li><a href="#build-the-crew" id="toc-build-the-crew" class="nav-link" data-scroll-target="#build-the-crew">Build the crew</a></li>
  <li><a href="#convert-the-report" id="toc-convert-the-report" class="nav-link" data-scroll-target="#convert-the-report">Convert the report</a></li>
  <li><a href="#review-the-report" id="toc-review-the-report" class="nav-link" data-scroll-target="#review-the-report">Review the report</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Using AI to draft Project Proposal</h1>
<p class="subtitle lead">Technical Approach Paper for Multi-Agent AI System</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Edouard Legoupil, Chief Data Officer, IOM </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">4 April 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>A Multi-Agent AI System is a computational framework where multiple autonomous agents interact to solve complex problems beyond the capability of individual agents. These systems are inspired by natural systems (e.g., human teams, ant colonies) and exhibit:</p>
<ul>
<li><p><strong>Autonomy</strong>: Agents operate independently with their own goals and decision-making.</p></li>
<li><p><strong>Decentralization</strong>: No single point of controlâ€”coordination emerges through interaction.</p></li>
<li><p><strong>Collaboration</strong>: Agents communicate, negotiate, or compete to achieve objectives.</p></li>
<li><p><strong>Scalability</strong>: Tasks can be distributed dynamically across agents.</p></li>
</ul>
<p>Multi-agent systems add significant value to AI-driven project proposal drafting by leveraging specialized agents to handle distinct tasks such as content generation, compliance checks, and reviews.</p>
<p>This collaborative approach ensures high accuracy, efficiency, and scalability, resulting in polished and competitive proposals. By automating repetitive tasks and iteratively improving content, multi-agent systems enhance the overall quality and speed of the proposal drafting process.</p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This notebook is designed for the audience to understand the basics of multi-agents systems so that they can effectively contribute to the collaborative work required to create them. We use <a href="https://www.crewai.com/">CrewAI</a>, an open source framework for building autonomous AI agents that work together to accomplish tasks. Basically, the 4 key steps are:</p>
<ol type="1">
<li><p>Define Your <strong>Agents</strong>: Agents are AI workers with roles, goals, and tools.</p></li>
<li><p>Create <strong>Tasks</strong>: Tasks define what each agent should do.</p></li>
<li><p>Assemble the <strong>Crew</strong>: Combine agents and tasks into a team.</p></li>
<li><p>Run the system: Execute and <strong>kickoff</strong> the workflow.</p></li>
</ol>
<hr>
<section id="environment-set-up" class="level2">
<h2 class="anchored" data-anchor-id="environment-set-up">Environment Set up</h2>
<p>The body of this document targets a technical audience. Below are all the codes so that the whole process can be reproduced and audited. This assume to use the following code within <a href="https://code.visualstudio.com/">Visual Studio Code</a>.</p>
<p>First we need to use a virtual environment in Python development. This is essential for managing dependencies, avoiding conflicts, and ensuring reproducibility. It allows you to isolate project-specific libraries and versions, preventing interference with other projects or the global Python installation. This isolation helps maintain a clean development environment, simplifies project setup for collaborators, and enhances security by reducing the risk of introducing vulnerabilities. Overall, virtual environments provide a consistent and organized way to manage your Python projects effectively.</p>
<p>Make sure to install the last <a href="https://www.python.org/downloads/">stable version of python language</a> and create a dedicated python environment to have a fresh install where to manage correctly all the dependencies between packages. To specify a particular version of Python when creating a virtual environment, you can use the full path to the desired Python executable. Here is how you can do it:</p>
<p>Open your terminal (Command Prompt, PowerShell, or any terminal emulator).</p>
<p>Navigate to your project directory where you want to create the virtual environment.</p>
<p>Run the following command to create a virtual environment,here called <strong><code>.venv</code></strong>:</p>
<ul>
<li><code>python -m venv .venv</code></li>
</ul>
<p>Then, activate the virtual environment:</p>
<ul>
<li><code>.\.venv\Scripts\activate</code></li>
</ul>
<p>Then, configure visual Studio Code to use the virtual environment: Open the Command Palette using the shortcut <code>Ctrl+Shift+P</code> and type <code>Jupyter: Select Interpreter</code> and select the interpreter that corresponds to your newly created virtual environment: <code>('venv': venv)</code>.</p>
<p>Once this environment selected as a kernel to run the notebook, we can install the required python modules the rest of the process:</p>
<div id="2c3b6bdf" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  dotenv <span class="co">## load env variable where I have API keys</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  langchain_openai <span class="co">## use langchain LLM server</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  datatime</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  python_docx <span class="co">## create word files</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  markdown <span class="co">## work with markdown files</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Install <code>CrewAI</code> and Explore the <a href="https://docs.crewai.com/introduction">documentation</a></p>
<div id="dce49fe9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>quiet  crewai </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>then Restart the jupyter kernel for this notebook</p>
<div id="18e41b8e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setting-up-llm-api" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-llm-api">Setting up LLM API</h2>
<section id="using-azure-open-ai" class="level3">
<h3 class="anchored" data-anchor-id="using-azure-open-ai">Using Azure Open AI</h3>
<p>https://blog.crewai.com/configuring-azure-openai-with-crewai-a-comprehensive-guide/</p>
<p>Note that it is key to get the environment variable precisely <a href="https://docs.litellm.ai/docs/providers/azure">as expected by litellm</a></p>
<div id="21fbc02a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load environment variables (Assuming you store API keys in a .env file)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>load_dotenv()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set all required environment variables explicitly</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"AZURE_API_TYPE"</span>] <span class="op">=</span> <span class="st">"azure"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"AZURE_API_BASE"</span>] <span class="op">=</span> os.getenv(<span class="st">"AZURE_OPENAI_ENDPOINT"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"AZURE_API_KEY"</span>] <span class="op">=</span> os.getenv(<span class="st">"AZURE_OPENAI_API_KEY"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"AZURE_API_VERSION"</span>] <span class="op">=</span> os.getenv(<span class="st">"OPENAI_API_VERSION"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"AZURE_DEPLOYMENT_NAME"</span>] <span class="op">=</span> os.getenv(<span class="st">"AZURE_DEPLOYMENT_NAME"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print all relevant variables for debugging</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify endpoint format - it MUST end with a forward slash</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#print("AZURE_OPENAI_ENDPOINT:",  "set" if os.getenv("AZURE_OPENAI_ENDPOINT") else "not set")</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#print("AZURE_OPENAI_API_KEY:", "set" if os.getenv("AZURE_OPENAI_API_KEY") else "not set")</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#print("AZURE_DEPLOYMENT_NAME:", os.getenv("AZURE_DEPLOYMENT_NAME"))</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#print("OPENAI_API_VERSION:", os.getenv("OPENAI_API_VERSION"))</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuring AzureChatOpenAI client...</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> langchain_openai <span class="im">import</span> AzureChatOpenAI</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>llm_azure <span class="op">=</span> AzureChatOpenAI(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    azure_deployment<span class="op">=</span>os.getenv(<span class="st">"AZURE_DEPLOYMENT_NAME"</span>),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    azure_endpoint<span class="op">=</span>os.getenv(<span class="st">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    api_key<span class="op">=</span>os.getenv(<span class="st">"AZURE_OPENAI_API_KEY"</span>),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    api_version<span class="op">=</span>os.getenv(<span class="st">"OPENAI_API_VERSION"</span>) ,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="ss">f"azure/</span><span class="sc">{</span>os<span class="sc">.</span>getenv(<span class="st">'AZURE_DEPLOYMENT_NAME'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    max_retries<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    timeout<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  max_tokens=2000  # max possible..</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span><span class="fl">0.3</span>,  <span class="co"># Adjust based on requirements</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checking if it works:</p>
<div id="773e910b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> llm_azure.invoke(<span class="st">"""If you have to create a humanitarian project proposal, </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">                               what are the key steps you would start and decision point</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">                              you need before starting writing the document?"""</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(response.content) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>When creating a humanitarian project proposal, there are several key steps and decision points to consider before starting to write the document. Here are the steps and decision points you should take into account:

1. Identify the problem or need: Determine the specific issue or need that your humanitarian project aims to address. Conduct thorough research to understand the root causes and the impact of the problem on the affected community.

2. Define the project objectives: Clearly articulate the goals and objectives of your project. What do you hope to achieve through your intervention? Ensure that your objectives are specific, measurable, achievable, relevant, and time-bound (SMART).

3. Conduct a needs assessment: Assess the needs of the target population or community. Understand their priorities, challenges, and existing resources. This will help you tailor your project to their specific requirements and ensure its effectiveness.

4. Develop a project plan: Create a detailed plan that outlines the activities, timeline, and resources required to implement the project. Consider the logistics, budget, staffing, and any necessary partnerships or collaborations.

5. Determine the project's sustainability: Consider the long-term sustainability of your project. How will it continue to have a positive impact after the initial implementation? Think about strategies for community involvement, capacity building, and the potential for local ownership.

6. Identify potential stakeholders: Identify the key stakeholders who will be involved in or affected by your project. This may include local communities, government agencies, NGOs, and other relevant organizations. Understand their interests, perspectives, and potential contributions to the project.

7. Establish a monitoring and evaluation framework: Determine how you will measure the success and impact of your project. Develop a monitoring and evaluation framework that includes relevant indicators, data collection methods, and tools to track progress and make necessary adjustments.

8. Consider ethical considerations: Reflect on the ethical implications of your project. Ensure that your intervention respects the dignity, culture, and rights of the affected community. Consider potential risks and develop strategies to mitigate them.

9. Secure funding and resources: Identify potential sources of funding and develop a comprehensive budget for your project. Consider the costs of implementation, monitoring, evaluation, and any necessary administrative expenses. Explore various funding opportunities, such as grants, partnerships, or crowdfunding.

10. Decision point: Once you have completed the above steps, you are ready to start writing the project proposal. Begin by outlining the problem, objectives, activities, expected outcomes, and budget. Ensure that your proposal is clear, concise, and well-structured, with a strong focus on the needs of the target population and the potential impact of your project.

Remember to tailor your proposal to the specific requirements of the funding organization or donor you are approaching.</code></pre>
</div>
</div>
<p>Setting up API key can be an issue, use the below chunk for debugging.</p>
<div id="a0febd55" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> crewai <span class="im">import</span> LLM</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> litellm</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>litellm._turn_on_debug()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>azure_llm <span class="op">=</span> LLM(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="ss">f"azure/</span><span class="sc">{</span>os<span class="sc">.</span>getenv(<span class="st">'AZURE_DEPLOYMENT_NAME'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>azure_response <span class="op">=</span> azure_llm.call(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"If you have to create a humanitarian project proposal, what are the key steps you would start and decision point you need before starting writing the document?"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\n</span><span class="ss">Azure Response:</span><span class="ch">\n\n</span><span class="sc">{</span>azure_response<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="first-iteration" class="level1">
<h1>First Iteration</h1>
<p>To start with we define 2 agents that work in a sequential way, one is drafting the report and the second one review it.</p>
<section id="build-the-crew" class="level2">
<h2 class="anchored" data-anchor-id="build-the-crew">Build the crew</h2>
<div id="093171d9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> crewai <span class="im">import</span> Crew, Agent, Task, Process</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ================= AGENTS =================</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>proposal_writer <span class="op">=</span> Agent(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    role<span class="op">=</span><span class="st">"Humanitarian Proposal Writer"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    llm<span class="op">=</span> llm_azure,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    goal<span class="op">=</span><span class="st">"Write compelling funding proposals for humanitarian projects"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    backstory<span class="op">=</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You are an expert in humanitarian aid and grant writing. "</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You have 10+ years of experience drafting proposals"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"and know how to structure them for maximum impact."</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    allow_delegation<span class="op">=</span><span class="va">False</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>proposal_reviewer <span class="op">=</span> Agent(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    role<span class="op">=</span><span class="st">"Proposal Quality Assurance Specialist"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    llm<span class="op">=</span>llm_azure,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    goal<span class="op">=</span><span class="st">"Ensure proposals meet funding criteria, follows strict formatting and content requirements and are well-structured"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    backstory<span class="op">=</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You are a grant evaluator for major humanitarian organizations. "</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You have a deep knowledge of donor expectations and proposal evaluation criteria."</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You are meticulous about formatting, word limits, and logical flow."</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"You know exactly what funders look for and how to improve proposals."</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    allow_delegation<span class="op">=</span><span class="va">False</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ================= TASKS =================</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>write_proposal <span class="op">=</span> Task(</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span>(</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Write a detailed project proposal for a humanitarian funding request. "</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The project aims to provide develop the usage of AI to improve IOM efficiency when drafting project proposal. The target donor is IOM, budget would be 130k$ and duration one year. The project scope is global"</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Include: Problem Statement, Objectives, Methodology, Budget, and Expected Impact."</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    expected_output<span class="op">=</span>(</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A well-structured proposal document formatted as markdown with clear sections: "</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1. Project Summary (350 words max)"</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2. Rationale (400 words max)"</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"3. Project Description ( - 600 words max)"</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"4. Partnerships and Coordination (Stakeholder mapping, cross-cutting themes -350 words max)"</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"5. Monitoring (350 words max)"</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"6. Evaluation (350 words max)"</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"7. Results Matrix (Objective, Outcome, Output, Indicators - formated as a table)"</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"8. Workplan (formated as a table - with activities, beging and end date, focal point)"</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"9. Budget (formated as a table)"</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"10. Risk Assessment and treatment plan (formated as a table: risk, conseuqnece, likelihood, treatment)"</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    agent<span class="op">=</span>proposal_writer,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    output_file<span class="op">=</span><span class="st">"output/version_1_project_document.md"</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>review_proposal <span class="op">=</span> Task(</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span>(</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Critically review the proposal draft and suggest improvements. "</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ensure that the theory of change is well articulated within the project description. "</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ensure clarity, alignment with donor expectations, and no errors."</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    expected_output<span class="op">=</span>(</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A revised proposal with tracked changes and recommendations. "</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A short summary of key improvements made."</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    agent<span class="op">=</span>proposal_reviewer,</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co"># ================= CREW CONFIGURATION =================</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>crew <span class="op">=</span> Crew(</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    agents<span class="op">=</span>[proposal_writer, proposal_reviewer],</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    tasks<span class="op">=</span>[write_proposal, review_proposal],</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    process<span class="op">=</span>Process.sequential,  <span class="co"># First write, then review</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span>  </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="co"># ================= EXECUTION =================</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>result1 <span class="op">=</span> crew.kickoff()</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"âœ… Proposal 1 generated successfully!"</span>)</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Crew Execution Started â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>                                                                                                                 <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">Crew Execution Started</span>                                                                                         <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Name: </span><span style="color: #008080; text-decoration-color: #008080">crew</span>                                                                                                     <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">ID: </span><span style="color: #008080; text-decoration-color: #008080">7e81a397-fe2c-4542-b5f8-7f9239ff1f8a</span>                                                                       <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>                                                                                                                 <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â”‚</span>                                                                                                                 <span style="color: #008080; text-decoration-color: #008080">â”‚</span>
<span style="color: #008080; text-decoration-color: #008080">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Agent: Humanitarian Proposal Writer
## Task: Write a detailed project proposal for a humanitarian funding request. The project aims to provide develop the usage of AI to improve IOM efficiency when drafting project proposal. The target donor is IOM, budget would be 130k$ and duration one year. The project scope is globalInclude: Problem Statement, Objectives, Methodology, Budget, and Expected Impact.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
        â””â”€â”€ <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">ðŸ§  </span><span style="color: #000080; text-decoration-color: #000080">Thinking...</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

# Agent: Humanitarian Proposal Writer
## Final Answer: 
# Project Proposal: Enhancing IOM Efficiency through AI in Project Proposal Drafting

## 1. Project Summary

The proposed project aims to leverage the power of Artificial Intelligence (AI) to enhance the efficiency of the International Organization for Migration (IOM) in drafting project proposals. With a budget of $130,000 and a duration of one year, the project will focus on developing an AI-powered platform that automates the process of project proposal drafting. By streamlining and optimizing this critical task, the project seeks to improve the overall effectiveness and impact of IOM's humanitarian initiatives on a global scale.

## 2. Rationale

The process of drafting project proposals is a time-consuming and resource-intensive task for IOM. The current manual approach often leads to delays, inconsistencies, and inefficiencies in proposal development. By harnessing the potential of AI, the proposed project aims to address these challenges and revolutionize the way project proposals are created. The use of AI technology will enable IOM to automate repetitive tasks, generate standardized content, and provide real-time feedback, resulting in faster and more accurate proposal development.

## 3. Project Description

The project will be divided into three main phases:

### Phase 1: Needs Assessment and AI Platform Development (4 months)

- Conduct a comprehensive needs assessment to identify key pain points and requirements for an AI-powered proposal drafting platform.
- Engage AI experts and software developers to design and develop a user-friendly platform that integrates natural language processing, machine learning, and data analytics capabilities.
- Test and refine the AI platform through iterative feedback and user testing to ensure its effectiveness and usability.

### Phase 2: Training and Implementation (6 months)

- Provide comprehensive training to IOM staff on the effective use of the AI platform for proposal drafting.
- Collaborate with IOM project teams to pilot the AI platform in real-world scenarios and gather feedback for further improvements.
- Continuously monitor and evaluate the performance of the AI platform to ensure its alignment with IOM's specific needs and requirements.

### Phase 3: Scaling and Sustainability (2 months)

- Develop a comprehensive scaling plan to expand the usage of the AI platform across all relevant IOM offices and departments.
- Establish a sustainable framework for the continuous improvement and maintenance of the AI platform, including regular updates and technical support.
- Document best practices and lessons learned to share with other humanitarian organizations and promote the adoption of AI in project proposal drafting.

## 4. Partnerships and Coordination

To ensure the successful implementation of the project, close partnerships and coordination will be established with key stakeholders, including:

- IOM staff and management at the global, regional, and country levels
- AI experts and software developers
- Donors and funding partners
- Other humanitarian organizations and relevant stakeholders

Cross-cutting themes, such as gender equality, inclusion, and environmental sustainability, will be integrated into the project design and implementation to ensure a holistic and responsible approach.

## 5. Monitoring

A robust monitoring system will be established to track the progress and impact of the project. Key monitoring activities will include:

- Regular data collection and analysis to measure the efficiency and effectiveness of the AI platform in proposal drafting.
- Feedback mechanisms to gather input from IOM staff and project teams on their experience with the AI platform.
- Periodic reporting and review meetings to assess the project's performance against the set objectives and make necessary adjustments.

## 6. Evaluation

An evaluation plan will be developed to assess the outcomes and impact of the project. The evaluation will focus on:

- The efficiency gains achieved through the use of the AI platform in proposal drafting.
- The quality and consistency of project proposals generated using the AI platform.
- The overall satisfaction and user experience of IOM staff and project teams with the AI platform.

## 7. Results Matrix

| Objective | Outcome | Output | Indicators |
|-----------|---------|--------|------------|
| Objective 1: Develop an AI-powered proposal drafting platform | Increased efficiency in proposal drafting process | AI platform prototype developed and tested | - Reduction in time required for proposal drafting&lt;br&gt;- Increase in the number of proposals drafted per unit of time |
| Objective 2: Enhance the quality and consistency of project proposals | Improved quality and consistency of project proposals | Standardized proposal templates and content generated by the AI platform | - Increase in the average score of proposal quality assessments&lt;br&gt;- Reduction in inconsistencies and errors in proposal content |
| Objective 3: Promote the adoption of AI in project proposal drafting | Increased awareness and knowledge of AI in proposal drafting | Best practices and lessons learned documented and shared | - Number of organizations adopting AI in proposal drafting&lt;br&gt;- Feedback and testimonials from other humanitarian organizations |

## 8. Workplan

| Activity | Start Date | End Date | Focal Point |
|----------|------------|----------|-------------|
| Needs assessment | Month 1 | Month 2 | Project Manager |
| AI platform development | Month 2 | Month 6 | AI Experts, Software Developers |
| Training and implementation | Month 3 | Month 9 | Project Manager, IOM Staff |
| Scaling and sustainability planning | Month 9 | Month 10 | Project Manager |
| Monitoring and evaluation | Throughout the project duration | - | Project Manager, Monitoring and Evaluation Officer |

## 9. Budget

| Category | Amount ($) |
|----------|------------|
| Personnel | 60,000 |
| AI Platform Development | 40,000 |
| Training and Implementation | 15,000 |
| Monitoring and Evaluation | 10,000 |
| Outreach and Dissemination | 5,000 |

## 10. Risk Assessment and Treatment Plan

| Risk | Consequence | Likelihood | Treatment |
|------|------------|------------|-----------|
| Limited staff buy-in and resistance to change | Delays in implementation and low adoption rate | Medium | Conduct comprehensive staff engagement and training sessions to address concerns and highlight the benefits of the AI platform. |
| Technical challenges in AI platform development | Incomplete or ineffective AI platform | Low | Engage experienced AI experts and software developers, conduct thorough testing and quality assurance processes. |
| Insufficient funding for scaling and maintenance | Inability to sustain the AI platform in the long term | Medium | Develop a sustainability plan, explore potential partnerships and funding opportunities, and seek additional funding support. |

The proposed project holds great potential to revolutionize the way IOM drafts project proposals, leading to increased efficiency, improved quality, and greater impact. By leveraging AI technology, IOM can enhance its humanitarian efforts and contribute to a more effective and sustainable response to global challenges.

</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Task Completion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">Task Completed</span>                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Name: </span><span style="color: #008000; text-decoration-color: #008000">35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>                                                                     <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>                                                                            <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Agent: Proposal Quality Assurance Specialist
## Task: Critically review the proposal draft and suggest improvements. Ensure that the theory of change is well articulated within the project description. Ensure clarity, alignment with donor expectations, and no errors.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
        â””â”€â”€ <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">ðŸ§  </span><span style="color: #000080; text-decoration-color: #000080">Thinking...</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">In Progress</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

# Agent: Proposal Quality Assurance Specialist
## Final Answer: 
# Project Proposal: Enhancing IOM Efficiency through AI in Project Proposal Drafting

## 1. Project Summary

The proposed project aims to leverage the power of Artificial Intelligence (AI) to enhance the efficiency of the International Organization for Migration (IOM) in drafting project proposals. With a budget of $130,000 and a duration of one year, the project will focus on developing an AI-powered platform that automates the process of project proposal drafting. By streamlining and optimizing this critical task, the project seeks to improve the overall effectiveness and impact of IOM's humanitarian initiatives on a global scale.

## 2. Rationale

The process of drafting project proposals is a time-consuming and resource-intensive task for IOM. The current manual approach often leads to delays, inconsistencies, and inefficiencies in proposal development. By harnessing the potential of AI, the proposed project aims to address these challenges and revolutionize the way project proposals are created. The use of AI technology will enable IOM to automate repetitive tasks, generate standardized content, and provide real-time feedback, resulting in faster and more accurate proposal development.

## 3. Project Description

The project will be divided into three main phases:

### Phase 1: Needs Assessment and AI Platform Development (4 months)

- Conduct a comprehensive needs assessment to identify key pain points and requirements for an AI-powered proposal drafting platform.
- Engage AI experts and software developers to design and develop a user-friendly platform that integrates natural language processing, machine learning, and data analytics capabilities.
- Test and refine the AI platform through iterative feedback and user testing to ensure its effectiveness and usability.

### Phase 2: Training and Implementation (6 months)

- Provide comprehensive training to IOM staff on the effective use of the AI platform for proposal drafting.
- Collaborate with IOM project teams to pilot the AI platform in real-world scenarios and gather feedback for further improvements.
- Continuously monitor and evaluate the performance of the AI platform to ensure its alignment with IOM's specific needs and requirements.

### Phase 3: Scaling and Sustainability (2 months)

- Develop a comprehensive scaling plan to expand the usage of the AI platform across all relevant IOM offices and departments.
- Establish a sustainable framework for the continuous improvement and maintenance of the AI platform, including regular updates and technical support.
- Document best practices and lessons learned to share with other humanitarian organizations and promote the adoption of AI in project proposal drafting.

## 4. Partnerships and Coordination

To ensure the successful implementation of the project, close partnerships and coordination will be established with key stakeholders, including:

- IOM staff and management at the global, regional, and country levels
- AI experts and software developers
- Donors and funding partners
- Other humanitarian organizations and relevant stakeholders

Cross-cutting themes, such as gender equality, inclusion, and environmental sustainability, will be integrated into the project design and implementation to ensure a holistic and responsible approach.

## 5. Monitoring

A robust monitoring system will be established to track the progress and impact of the project. Key monitoring activities will include:

- Regular data collection and analysis to measure the efficiency and effectiveness of the AI platform in proposal drafting.
- Feedback mechanisms to gather input from IOM staff and project teams on their experience with the AI platform.
- Periodic reporting and review meetings to assess the project's performance against the set objectives and make necessary adjustments.

## 6. Evaluation

An evaluation plan will be developed to assess the outcomes and impact of the project. The evaluation will focus on:

- The efficiency gains achieved through the use of the AI platform in proposal drafting.
- The quality and consistency of project proposals generated using the AI platform.
- The overall satisfaction and user experience of IOM staff and project teams with the AI platform.

## 7. Results Matrix

| Objective | Outcome | Output | Indicators |
|-----------|---------|--------|------------|
| Objective 1: Develop an AI-powered proposal drafting platform | Increased efficiency in proposal drafting process | AI platform prototype developed and tested | - Reduction in time required for proposal drafting&lt;br&gt;- Increase in the number of proposals drafted per unit of time |
| Objective 2: Enhance the quality and consistency of project proposals | Improved quality and consistency of project proposals | Standardized proposal templates and content generated by the AI platform | - Increase in the average score of proposal quality assessments&lt;br&gt;- Reduction in inconsistencies and errors in proposal content |
| Objective 3: Promote the adoption of AI in project proposal drafting | Increased awareness and knowledge of AI in proposal drafting | Best practices and lessons learned documented and shared | - Number of organizations adopting AI in proposal drafting&lt;br&gt;- Feedback and testimonials from other humanitarian organizations |

## 8. Workplan

| Activity | Start Date | End Date | Focal Point |
|----------|------------|----------|-------------|
| Needs assessment | Month 1 | Month 2 | Project Manager |
| AI platform development | Month 2 | Month 6 | AI Experts, Software Developers |
| Training and implementation | Month 3 | Month 9 | Project Manager, IOM Staff |
| Scaling and sustainability planning | Month 9 | Month 10 | Project Manager |
| Monitoring and evaluation | Throughout the project duration | - | Project Manager, Monitoring and Evaluation Officer |

## 9. Budget

| Category | Amount ($) |
|----------|------------|
| Personnel | 60,000 |
| AI Platform Development | 40,000 |
| Training and Implementation | 15,000 |
| Monitoring and Evaluation | 10,000 |
| Outreach and Dissemination | 5,000 |

## 10. Risk Assessment and Treatment Plan

| Risk | Consequence | Likelihood | Treatment |
|------|------------|------------|-----------|
| Limited staff buy-in and resistance to change | Delays in implementation and low adoption rate | Medium | Conduct comprehensive staff engagement and training sessions to address concerns and highlight the benefits of the AI platform. |
| Technical challenges in AI platform development | Incomplete or ineffective AI platform | Low | Engage experienced AI experts and software developers, conduct thorough testing and quality assurance processes. |
| Insufficient funding for scaling and maintenance | Inability to sustain the AI platform in the long term | Medium | Develop a sustainability plan, explore potential partnerships and funding opportunities, and seek additional funding support. |

Summary of Key Improvements Made:

1. Clarified the objective of the project to enhance the efficiency of IOM in drafting project proposals through the use of AI.
2. Added a rationale section to explain the challenges of the current manual approach and the potential benefits of AI technology.
3. Provided a more detailed project description, including the three main phases of the project and the specific activities to be carried out in each phase.
4. Emphasized the importance of partnerships and coordination with key stakeholders.
5. Included cross-cutting themes to ensure a holistic and responsible approach.
6. Expanded the monitoring and evaluation sections to include specific activities and indicators.
7. Updated the results matrix to clearly define the objectives, outcomes, outputs, and indicators.
8. Revised the workplan to include specific start and end dates for each activity.
9. Provided a detailed budget breakdown.
10. Added a risk assessment and treatment plan to address potential challenges and mitigate risks.

Overall, these improvements ensure that the proposal is well-structured, aligned with donor expectations, and provides a clear and comprehensive plan for enhancing IOM's efficiency in project proposal drafting through the use of AI.

</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #bfbf7f; text-decoration-color: #bfbf7f">Executing Task...</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">ðŸš€ Crew: crew</span>
â”œâ”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 35b404b2-1a6b-4c0d-85ce-77949f328ba1</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚   <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â”‚   â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Humanitarian Proposal Writer</span>
â”‚       <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ“‹ Task: 14261f8e-6402-44cb-9b64-0794bca9626d</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Assigned to: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
    <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">   Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
    â””â”€â”€ <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ðŸ¤– Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>
        <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">    Status: </span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">âœ… Completed</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Task Completion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">Task Completed</span>                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Name: </span><span style="color: #008000; text-decoration-color: #008000">14261f8e-6402-44cb-9b64-0794bca9626d</span>                                                                     <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Agent: </span><span style="color: #008000; text-decoration-color: #008000">Proposal Quality Assurance Specialist</span>                                                                   <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Crew Completion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">Crew Execution Completed</span>                                                                                       <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">Name: </span><span style="color: #008000; text-decoration-color: #008000">crew</span>                                                                                                     <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>  <span style="color: #c0c0c0; text-decoration-color: #c0c0c0">ID: </span><span style="color: #008000; text-decoration-color: #008000">7e81a397-fe2c-4542-b5f8-7f9239ff1f8a</span>                                                                       <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â”‚</span>                                                                                                                 <span style="color: #008000; text-decoration-color: #008000">â”‚</span>
<span style="color: #008000; text-decoration-color: #008000">â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>âœ… Proposal 1 generated successfully!
# Project Proposal: Enhancing IOM Efficiency through AI in Project Proposal Drafting

## 1. Project Summary

The proposed project aims to leverage the power of Artificial Intelligence (AI) to enhance the efficiency of the International Organization for Migration (IOM) in drafting project proposals. With a budget of $130,000 and a duration of one year, the project will focus on developing an AI-powered platform that automates the process of project proposal drafting. By streamlining and optimizing this critical task, the project seeks to improve the overall effectiveness and impact of IOM's humanitarian initiatives on a global scale.

## 2. Rationale

The process of drafting project proposals is a time-consuming and resource-intensive task for IOM. The current manual approach often leads to delays, inconsistencies, and inefficiencies in proposal development. By harnessing the potential of AI, the proposed project aims to address these challenges and revolutionize the way project proposals are created. The use of AI technology will enable IOM to automate repetitive tasks, generate standardized content, and provide real-time feedback, resulting in faster and more accurate proposal development.

## 3. Project Description

The project will be divided into three main phases:

### Phase 1: Needs Assessment and AI Platform Development (4 months)

- Conduct a comprehensive needs assessment to identify key pain points and requirements for an AI-powered proposal drafting platform.
- Engage AI experts and software developers to design and develop a user-friendly platform that integrates natural language processing, machine learning, and data analytics capabilities.
- Test and refine the AI platform through iterative feedback and user testing to ensure its effectiveness and usability.

### Phase 2: Training and Implementation (6 months)

- Provide comprehensive training to IOM staff on the effective use of the AI platform for proposal drafting.
- Collaborate with IOM project teams to pilot the AI platform in real-world scenarios and gather feedback for further improvements.
- Continuously monitor and evaluate the performance of the AI platform to ensure its alignment with IOM's specific needs and requirements.

### Phase 3: Scaling and Sustainability (2 months)

- Develop a comprehensive scaling plan to expand the usage of the AI platform across all relevant IOM offices and departments.
- Establish a sustainable framework for the continuous improvement and maintenance of the AI platform, including regular updates and technical support.
- Document best practices and lessons learned to share with other humanitarian organizations and promote the adoption of AI in project proposal drafting.

## 4. Partnerships and Coordination

To ensure the successful implementation of the project, close partnerships and coordination will be established with key stakeholders, including:

- IOM staff and management at the global, regional, and country levels
- AI experts and software developers
- Donors and funding partners
- Other humanitarian organizations and relevant stakeholders

Cross-cutting themes, such as gender equality, inclusion, and environmental sustainability, will be integrated into the project design and implementation to ensure a holistic and responsible approach.

## 5. Monitoring

A robust monitoring system will be established to track the progress and impact of the project. Key monitoring activities will include:

- Regular data collection and analysis to measure the efficiency and effectiveness of the AI platform in proposal drafting.
- Feedback mechanisms to gather input from IOM staff and project teams on their experience with the AI platform.
- Periodic reporting and review meetings to assess the project's performance against the set objectives and make necessary adjustments.

## 6. Evaluation

An evaluation plan will be developed to assess the outcomes and impact of the project. The evaluation will focus on:

- The efficiency gains achieved through the use of the AI platform in proposal drafting.
- The quality and consistency of project proposals generated using the AI platform.
- The overall satisfaction and user experience of IOM staff and project teams with the AI platform.

## 7. Results Matrix

| Objective | Outcome | Output | Indicators |
|-----------|---------|--------|------------|
| Objective 1: Develop an AI-powered proposal drafting platform | Increased efficiency in proposal drafting process | AI platform prototype developed and tested | - Reduction in time required for proposal drafting&lt;br&gt;- Increase in the number of proposals drafted per unit of time |
| Objective 2: Enhance the quality and consistency of project proposals | Improved quality and consistency of project proposals | Standardized proposal templates and content generated by the AI platform | - Increase in the average score of proposal quality assessments&lt;br&gt;- Reduction in inconsistencies and errors in proposal content |
| Objective 3: Promote the adoption of AI in project proposal drafting | Increased awareness and knowledge of AI in proposal drafting | Best practices and lessons learned documented and shared | - Number of organizations adopting AI in proposal drafting&lt;br&gt;- Feedback and testimonials from other humanitarian organizations |

## 8. Workplan

| Activity | Start Date | End Date | Focal Point |
|----------|------------|----------|-------------|
| Needs assessment | Month 1 | Month 2 | Project Manager |
| AI platform development | Month 2 | Month 6 | AI Experts, Software Developers |
| Training and implementation | Month 3 | Month 9 | Project Manager, IOM Staff |
| Scaling and sustainability planning | Month 9 | Month 10 | Project Manager |
| Monitoring and evaluation | Throughout the project duration | - | Project Manager, Monitoring and Evaluation Officer |

## 9. Budget

| Category | Amount ($) |
|----------|------------|
| Personnel | 60,000 |
| AI Platform Development | 40,000 |
| Training and Implementation | 15,000 |
| Monitoring and Evaluation | 10,000 |
| Outreach and Dissemination | 5,000 |

## 10. Risk Assessment and Treatment Plan

| Risk | Consequence | Likelihood | Treatment |
|------|------------|------------|-----------|
| Limited staff buy-in and resistance to change | Delays in implementation and low adoption rate | Medium | Conduct comprehensive staff engagement and training sessions to address concerns and highlight the benefits of the AI platform. |
| Technical challenges in AI platform development | Incomplete or ineffective AI platform | Low | Engage experienced AI experts and software developers, conduct thorough testing and quality assurance processes. |
| Insufficient funding for scaling and maintenance | Inability to sustain the AI platform in the long term | Medium | Develop a sustainability plan, explore potential partnerships and funding opportunities, and seek additional funding support. |

Summary of Key Improvements Made:

1. Clarified the objective of the project to enhance the efficiency of IOM in drafting project proposals through the use of AI.
2. Added a rationale section to explain the challenges of the current manual approach and the potential benefits of AI technology.
3. Provided a more detailed project description, including the three main phases of the project and the specific activities to be carried out in each phase.
4. Emphasized the importance of partnerships and coordination with key stakeholders.
5. Included cross-cutting themes to ensure a holistic and responsible approach.
6. Expanded the monitoring and evaluation sections to include specific activities and indicators.
7. Updated the results matrix to clearly define the objectives, outcomes, outputs, and indicators.
8. Revised the workplan to include specific start and end dates for each activity.
9. Provided a detailed budget breakdown.
10. Added a risk assessment and treatment plan to address potential challenges and mitigate risks.

Overall, these improvements ensure that the proposal is well-structured, aligned with donor expectations, and provides a clear and comprehensive plan for enhancing IOM's efficiency in project proposal drafting through the use of AI.</code></pre>
</div>
</div>
</section>
<section id="convert-the-report" class="level2">
<h2 class="anchored" data-anchor-id="convert-the-report">Convert the report</h2>
<p>The report has been saved as a markdown file. We can then easily convert it in different format (docx, html..) through the function below:</p>
<div id="c8617e5b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> markdown</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx <span class="im">import</span> Document</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.shared <span class="im">import</span> Pt, RGBColor, Inches</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.enum.table <span class="im">import</span> WD_TABLE_ALIGNMENT, WD_ALIGN_VERTICAL</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.enum.text <span class="im">import</span> WD_PARAGRAPH_ALIGNMENT</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.oxml <span class="im">import</span> parse_xml</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.oxml.ns <span class="im">import</span> nsdecls</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.oxml <span class="im">import</span> OxmlElement</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx.oxml.ns <span class="im">import</span> qn</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_markdown_to_formats(md_file_path, output_dir<span class="op">=</span><span class="st">"output"</span>):</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Convert a markdown file to both Word and HTML formats with professional table support.</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">        md_file_path: Path to the input markdown file</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">        output_dir: Directory to save output files (default: "output")</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">        Dictionary with paths to generated files {'word': path, 'html': path}</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create output directory if it doesn't exist</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    Path(output_dir).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get base filename without extension</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    base_name <span class="op">=</span> Path(md_file_path).stem</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    output_paths <span class="op">=</span> {}</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read markdown content</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(md_file_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            md_content <span class="op">=</span> f.read()</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Convert to HTML ---</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> markdown.markdown(md_content, extensions<span class="op">=</span>[<span class="st">'tables'</span>, <span class="st">'fenced_code'</span>])</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Wrap in basic HTML structure</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        full_html <span class="op">=</span> <span class="ss">f"""&lt;!DOCTYPE html&gt;</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html&gt;</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset="UTF-8"&gt;</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">&lt;/title&gt;</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; </span><span class="ch">}}</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1, h2, h3 </span><span class="ch">{{</span><span class="ss"> color: #0033A0; </span><span class="ch">}}</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span><span class="ss"> background: #f8f9fa; padding: 2px 4px; border-radius: 4px; </span><span class="ch">}}</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; </span><span class="ch">}}</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span><span class="ss"> border-collapse: collapse; width: 100%; margin: 20px 0; </span><span class="ch">}}</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span><span class="ss"> border: 1px solid #ddd; padding: 8px; text-align: left; </span><span class="ch">}}</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span><span class="ss"> background-color: #f2f2f2; font-weight: bold; </span><span class="ch">}}</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>html_content<span class="sc">}</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;"""</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save HTML</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>        html_path <span class="op">=</span> os.path.join(output_dir, <span class="ss">f"</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">.html"</span>)</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(html_path, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>            f.write(full_html)</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>        output_paths[<span class="st">'html'</span>] <span class="op">=</span> html_path</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --- Convert to Word with advanced table support ---</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>        doc <span class="op">=</span> Document()</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set default document styles</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>        style <span class="op">=</span> doc.styles[<span class="st">'Normal'</span>]</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>        font <span class="op">=</span> style.font</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>        font.name <span class="op">=</span> <span class="st">'Calibri'</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>        font.size <span class="op">=</span> Pt(<span class="dv">11</span>)</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process content line by line, detecting tables reliably</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> md_content.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>        current_table <span class="op">=</span> []</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>        in_table <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>        current_paragraph <span class="op">=</span> []</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> lines:</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if we're starting a table</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> in_table <span class="kw">and</span> line.strip().startswith(<span class="st">'|'</span>) <span class="kw">and</span> <span class="st">'|'</span> <span class="kw">in</span> line[<span class="dv">1</span>:]:</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> current_paragraph:  <span class="co"># Flush any pending paragraph content</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>                    doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_paragraph))</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>                    current_paragraph <span class="op">=</span> []</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>                in_table <span class="op">=</span> <span class="va">True</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>                current_table <span class="op">=</span> [line]</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> in_table:</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Continue collecting table lines until we hit a non-table line</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> line.strip().startswith(<span class="st">'|'</span>) <span class="kw">or</span> line.strip().startswith(<span class="st">'|-'</span>) <span class="kw">or</span> <span class="kw">not</span> line.strip():</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>                    current_table.append(line)</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Process the accumulated table</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">len</span>(current_table) <span class="op">&gt;=</span> <span class="dv">2</span>:  <span class="co"># Need at least header and separator</span></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>                        process_markdown_table(doc, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_table))</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Not a valid table, add as regular text</span></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>                        doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_table))</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>                    in_table <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>                    current_table <span class="op">=</span> []</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Process the current non-table line</span></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>                    process_markdown_content(doc, line)</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Regular content</span></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>                process_markdown_content(doc, line, current_paragraph)</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process any remaining content</span></span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_table <span class="kw">and</span> <span class="bu">len</span>(current_table) <span class="op">&gt;=</span> <span class="dv">2</span>:</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>            process_markdown_table(doc, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_table))</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_paragraph:</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>            doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_paragraph))</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save Word document</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>        word_path <span class="op">=</span> os.path.join(output_dir, <span class="ss">f"</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">.docx"</span>)</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>        doc.save(word_path)</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>        output_paths[<span class="st">'word'</span>] <span class="op">=</span> word_path</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"âœ… Converted </span><span class="sc">{</span>md_file_path<span class="sc">}</span><span class="ss"> to:"</span>)</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - Word: </span><span class="sc">{</span>word_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - HTML: </span><span class="sc">{</span>html_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output_paths</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"âŒ Error converting </span><span class="sc">{</span>md_file_path<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_markdown_content(doc, content, current_paragraph<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Process regular markdown content (non-tables)"""</span></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_paragraph <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>        current_paragraph <span class="op">=</span> []</span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> content.strip() <span class="kw">and</span> <span class="kw">not</span> current_paragraph:</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle headings</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> content.startswith(<span class="st">'# '</span>):</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_paragraph:</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>            doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_paragraph))</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>            current_paragraph <span class="op">=</span> []</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>        heading <span class="op">=</span> doc.add_heading(content[<span class="dv">2</span>:].strip(), level<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>        apply_heading_style(heading)</span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> content.startswith(<span class="st">'## '</span>):</span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_paragraph:</span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>            doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_paragraph))</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a>            current_paragraph <span class="op">=</span> []</span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>        heading <span class="op">=</span> doc.add_heading(content[<span class="dv">3</span>:].strip(), level<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>        apply_heading_style(heading)</span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> content.startswith(<span class="st">'### '</span>):</span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_paragraph:</span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>            doc.add_paragraph(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(current_paragraph))</span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>            current_paragraph <span class="op">=</span> []</span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>        heading <span class="op">=</span> doc.add_heading(content[<span class="dv">4</span>:].strip(), level<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a>        apply_heading_style(heading)</span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content.strip() <span class="kw">or</span> current_paragraph:</span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>            current_paragraph.append(content)</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_heading_style(heading):</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Apply consistent heading styles"""</span></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>    heading.style.font.color.rgb <span class="op">=</span> RGBColor(<span class="bn">0x2A</span>, <span class="bn">0x54</span>, <span class="bn">0x8B</span>)   <span class="co"># IOM blue</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>    heading.paragraph_format.space_after <span class="op">=</span> Pt(<span class="dv">6</span>)</span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>    heading.paragraph_format.space_before <span class="op">=</span> Pt(<span class="dv">12</span>)</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_markdown_table(doc, table_text):</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Convert markdown table to Word table with proper handling of blank lines and formatting"""</span></span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [line.rstrip() <span class="cf">for</span> line <span class="kw">in</span> table_text.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>) <span class="cf">if</span> line.strip() <span class="kw">or</span> line <span class="op">==</span> <span class="st">''</span>]</span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parse the table structure</span></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>    rows <span class="op">=</span> []</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>    current_row <span class="op">=</span> []</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>    in_multiline_cell <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> lines:</span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> line.strip():</span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Blank line - continue current cell if we're in a multiline cell</span></span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_multiline_cell <span class="kw">and</span> current_row:</span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a>                current_row[<span class="op">-</span><span class="dv">1</span>] <span class="op">+=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span></span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.startswith(<span class="st">'|'</span>) <span class="kw">and</span> line.endswith(<span class="st">'|'</span>):</span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Standard table row</span></span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>            cells <span class="op">=</span> [cell.strip() <span class="cf">for</span> cell <span class="kw">in</span> line[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split(<span class="st">'|'</span>)]</span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> in_multiline_cell:</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a>                current_row <span class="op">=</span> cells</span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>                rows.append(current_row)</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Continuation of multiline cell</span></span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, cell <span class="kw">in</span> <span class="bu">enumerate</span>(cells):</span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(current_row):</span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a>                        current_row[i] <span class="op">+=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> cell</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>                in_multiline_cell <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> line.startswith(<span class="st">'|---'</span>):</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Skip separator lines but mark that we have a header</span></span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Content that belongs to a multiline cell</span></span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> rows <span class="kw">and</span> current_row:</span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(current_row)):</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a>                    current_row[i] <span class="op">+=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> line</span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a>                in_multiline_cell <span class="op">=</span> <span class="va">True</span></span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out empty rows and validate</span></span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a>    rows <span class="op">=</span> [row <span class="cf">for</span> row <span class="kw">in</span> rows <span class="cf">if</span> <span class="bu">any</span>(cell.strip() <span class="cf">for</span> cell <span class="kw">in</span> row)]</span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> rows <span class="kw">or</span> <span class="kw">not</span> <span class="bu">any</span>(rows):</span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a>        doc.add_paragraph(table_text)</span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create Word table</span></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a>    num_cols <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(row) <span class="cf">for</span> row <span class="kw">in</span> rows)</span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a>    table <span class="op">=</span> doc.add_table(rows<span class="op">=</span><span class="bu">len</span>(rows), cols<span class="op">=</span>num_cols)</span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply table styling</span></span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>    tbl <span class="op">=</span> table._tbl</span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>    tblPr <span class="op">=</span> tbl.tblPr</span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a>    tblBorders <span class="op">=</span> OxmlElement(<span class="st">'w:tblBorders'</span>)</span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> border_name <span class="kw">in</span> [<span class="st">'top'</span>, <span class="st">'left'</span>, <span class="st">'bottom'</span>, <span class="st">'right'</span>, <span class="st">'insideH'</span>, <span class="st">'insideV'</span>]:</span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a>        border <span class="op">=</span> OxmlElement(<span class="ss">f'w:</span><span class="sc">{</span>border_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a>        border.<span class="bu">set</span>(qn(<span class="st">'w:val'</span>), <span class="st">'single'</span>)</span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a>        border.<span class="bu">set</span>(qn(<span class="st">'w:sz'</span>), <span class="st">'4'</span>)</span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a>        border.<span class="bu">set</span>(qn(<span class="st">'w:space'</span>), <span class="st">'0'</span>)</span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>        border.<span class="bu">set</span>(qn(<span class="st">'w:color'</span>), <span class="st">'000000'</span>)</span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>        tblBorders.append(border)</span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a>    tblPr.append(tblBorders)</span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Populate table cells</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(rows):</span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_cols):</span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>            cell_content <span class="op">=</span> row[j] <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(row) <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>            cell_content <span class="op">=</span> clean_cell_content(cell_content)</span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>            table.cell(i, j).text <span class="op">=</span> cell_content</span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a>            table.cell(i, j).vertical_alignment <span class="op">=</span> WD_ALIGN_VERTICAL.TOP</span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Header row formatting (if we had a separator line)</span></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> <span class="bu">any</span>(<span class="st">'|---'</span> <span class="kw">in</span> line <span class="cf">for</span> line <span class="kw">in</span> lines):</span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a>                table.cell(i, j).paragraphs[<span class="dv">0</span>].runs[<span class="dv">0</span>].bold <span class="op">=</span> <span class="va">True</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>                shading_elm <span class="op">=</span> table.cell(i, j)._tc.get_or_add_tcPr()</span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>                shading_elm.append(parse_xml(</span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>                    <span class="vs">r'&lt;w:shd </span><span class="sc">{}</span><span class="vs"> w:fill="D3D3D3"/&gt;'</span>.<span class="bu">format</span>(nsdecls(<span class="st">'w'</span>))</span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a>                ))</span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adjust column width based on content</span></span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a>            max_line_len <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(line) <span class="cf">for</span> line <span class="kw">in</span> cell_content.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)) <span class="cf">if</span> cell_content <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> max_line_len <span class="op">&gt;</span> <span class="dv">30</span>:</span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>                table.columns[j].width <span class="op">=</span> Inches(<span class="fl">2.5</span>)</span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> max_line_len <span class="op">&gt;</span> <span class="dv">15</span>:</span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a>                table.columns[j].width <span class="op">=</span> Inches(<span class="fl">1.75</span>)</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a>                table.columns[j].width <span class="op">=</span> Inches(<span class="fl">1.0</span>)</span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add spacing after table</span></span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a>    doc.add_paragraph()</span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_cell_content(content):</span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Clean up markdown formatting in table cells"""</span></span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove any remaining markdown formatting</span></span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> re.sub(<span class="vs">r'\[(.*?)\]\(.*?\)'</span>, <span class="vs">r'\1'</span>, content)  <span class="co"># Remove links</span></span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> re.sub(<span class="vs">r'\*\*(.*?)\*\*'</span>, <span class="vs">r'\1'</span>, content)     <span class="co"># Remove bold</span></span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> re.sub(<span class="vs">r'\*(.*?)\*'</span>, <span class="vs">r'\1'</span>, content)         <span class="co"># Remove italic</span></span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> re.sub(<span class="vs">r'`(.*?)`'</span>, <span class="vs">r'\1'</span>, content)           <span class="co"># Remove code</span></span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> re.sub(<span class="vs">r'&lt;br\s*/?&gt;'</span>, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, content)          <span class="co"># Convert &lt;br&gt; to newline</span></span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean up newlines</span></span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [line.strip() <span class="cf">for</span> line <span class="kw">in</span> content.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)]</span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(<span class="bu">filter</span>(<span class="va">None</span>, lines))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b182e7a7" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>convert_markdown_to_formats(md_file_path<span class="op">=</span><span class="st">"output/version_1_project_document.md"</span>, output_dir<span class="op">=</span><span class="st">"output"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>âœ… Converted output/version_1_project_document.md to:
  - Word: output\version_1_project_document.docx
  - HTML: output\version_1_project_document.html</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>{'html': 'output\\version_1_project_document.html',
 'word': 'output\\version_1_project_document.docx'}</code></pre>
</div>
</div>
</section>
<section id="review-the-report" class="level2">
<h2 class="anchored" data-anchor-id="review-the-report">Review the report</h2>
<div class="embedded-content">
<iframe src="output/version_1_project_document.html" style="width: 100%; height: 500px; border: none;"></iframe>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this notebook, we have presented just the result of an initial exploration. More work is required and is in the making to get such system into production.</p>
<p>This requires a lot of experimentation in the definition of the different agents &amp; tasks. For instance:</p>
<ul>
<li><p>The knowledge from <a href="https://publications.iom.int/system/files/pdf/iom_project_handbook_6feb2012.pdf">IOM Project Handbook</a> needs also to be more systematically extracted with <a href="https://docs.crewai.com/tools/llamaindextool">LlamaIndex Tool</a>, ideally through a Questions &amp; Answers format to more strictly inform the specific task from each agents.</p></li>
<li><p>In addition, the system can benefit from the integration of tools like <a href="https://docs.crewai.com/tools/serperdevtool">Google Serper Search</a>, and RAG tools to extract the standard indicators to use from IOM standard logframe, or to leverage learnings from <a href="https://edouard-legoupil.github.io/rag_extraction/">Evaluation Reports</a> as well as custom Machine Learning APIs (for instance to <a href="https://iom-dia-na.netlify.app/iom_dim">predict donors funding appetite</a> based on existing data).</p></li>
</ul>
<div id="cf49a8dd" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> crewai_tools <span class="im">import</span> SerperDevTool</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>search_tool <span class="op">=</span> SerperDevTool()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>researcher <span class="op">=</span> Agent(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    role<span class="op">=</span><span class="st">'Researcher'</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    tools<span class="op">=</span>[search_tool],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (rest of the agent definition)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have reached acceptable results, we can just combine all of this into a python function and build an html/js interface to collect the parmeters from the users and output the results.</p>
</section>

</main>
<!-- /main column -->
<div class="py-4 column-screen page-columns page-full" style="background-color: #333333">

  <div class="column-body">

    <a href="https://www.iom.int/" target="_blank" rel="noopener noreferrer">

      <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNS4yLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgdmVyc2lvbj0iMS4xIgogICBpZD0iTGF5ZXJfMSIKICAgeD0iMHB4IgogICB5PSIwcHgiCiAgIHZpZXdCb3g9IjAgMCAyNTEuMTMwMDEgOTQuNjYwMDA1IgogICB4bWw6c3BhY2U9InByZXNlcnZlIgogICBzb2RpcG9kaTpkb2NuYW1lPSJpb21fbG9nb193aGl0ZS5zdmciCiAgIHdpZHRoPSIyNTEuMTMiCiAgIGhlaWdodD0iOTQuNjYwMDA0IgogICBpbmtzY2FwZTp2ZXJzaW9uPSIxLjEuMiAoMGEwMGNmNTMzOSwgMjAyMi0wMi0wNCkiCiAgIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIgogICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnMKICAgaWQ9ImRlZnM5MSIgLz48c29kaXBvZGk6bmFtZWR2aWV3CiAgIGlkPSJuYW1lZHZpZXc4OSIKICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICBzaG93Z3JpZD0iZmFsc2UiCiAgIGZpdC1tYXJnaW4tdG9wPSIwIgogICBmaXQtbWFyZ2luLWxlZnQ9IjAiCiAgIGZpdC1tYXJnaW4tcmlnaHQ9IjAiCiAgIGZpdC1tYXJnaW4tYm90dG9tPSIwIgogICBpbmtzY2FwZTp6b29tPSI1LjU3NzY4OTQiCiAgIGlua3NjYXBlOmN4PSIxMTcuNzAxMDciCiAgIGlua3NjYXBlOmN5PSI0OS4yMTM5MjciCiAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMzQ0MCIKICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTQxMiIKICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJMYXllcl8xIiAvPgo8c3R5bGUKICAgdHlwZT0idGV4dC9jc3MiCiAgIGlkPSJzdHlsZTIiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgo8ZwogICBpZD0iZzQyIgogICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjcuMzMsLTYzLjYpIgogICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIj48cmVjdAogICAgIHg9IjEyMi40IgogICAgIHk9IjY0LjQwMDAwMiIKICAgICBjbGFzcz0ic3QwIgogICAgIHdpZHRoPSI4LjgyOTk5OTkiCiAgICAgaGVpZ2h0PSI2MS40NTAwMDEiCiAgICAgaWQ9InJlY3Q0IgogICAgIHN0eWxlPSJmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjEiIC8+PHBhdGgKICAgICBjbGFzcz0ic3QwIgogICAgIGQ9Im0gMTc2LjI4LDExOC40NiBjIC0xMi44OSwwIC0yMy44OCwtOS4xOSAtMjMuODgsLTIzLjE2IDAsLTEwLjI3IDYuOTQsLTIzLjQzIDI0LjE1LC0yMy40MyAxNi4wNCwwIDIzLjc5LDEyLjg5IDIzLjc5LDIzLjA2IDAsNS4zMiAtMi4yNSwxMS45OCAtNi4xMywxNi4yMiAtNC4yMyw0LjYxIC0xMS4zNSw3LjMxIC0xNy45Myw3LjMxIG0gMzMuMDcsLTIzLjQyIGMgMCwtMTYuNDkgLTEyLjcsLTMxLjQ0IC0zMy4xNiwtMzEuNDQgLTIwLjk5LDAgLTMyLjg5LDE1LjQxIC0zMi44OSwzMS43MSAwLDE3LjEyIDEzLjE1LDMxLjM1IDMyLjQzLDMxLjM1IDIwLjEsMCAzMy42MiwtMTMuOTYgMzMuNjIsLTMxLjYyIgogICAgIGlkPSJwYXRoNiIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwb2x5Z29uCiAgICAgY2xhc3M9InN0MCIKICAgICBwb2ludHM9IjIyOS45OSwxMjUuODUgMjI5Ljk5LDc4LjAxIDI0OS4wOSwxMDEuNzkgMjUwLjcxLDEwMS43OSAyNjkuNjMsNzguMDEgMjY5LjYzLDEyNS44NSAyNzguNDYsMTI1Ljg1IDI3OC40Niw2NC40IDI3MC4yNiw2NC40IDI0OS45LDg5LjYzIDIyOS40NCw2NC40IDIyMS4xNiw2NC40IDIyMS4xNiwxMjUuODUgIgogICAgIGlkPSJwb2x5Z29uOCIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwYXRoCiAgICAgY2xhc3M9InN0MCIKICAgICBkPSJtIDQyLjk1LDE0OS4xMyBjIDAsMi4wMSAtMC4xOCwzLjA5IC0wLjU4LDMuODEgLTAuNTUsMC45OSAtMi4wMiwyLjcgLTUuMzksMi43IC0yLjQyLDAgLTMuOCwtMC44MSAtNC42OSwtMS43MSAtMS4wNywtMS4wNSAtMS4zMiwtMi4xIC0xLjMyLC00LjggdiAtMTEuNjIgaCAtMyB2IDExLjYyIGMgMCwxLjM4IDAsMy43NSAxLjE2LDUuNTYgMS42NSwyLjU4IDQuOSwzLjU3IDcuODQsMy41NyAyLjM5LDAgNC43MiwtMC42IDYuNTksLTIuMjIgMi4zNiwtMi4wNyAyLjM2LC00LjkzIDIuMzYsLTYuOTEgdiAtMTEuNjIgaCAtMi45NyB6IgogICAgIGlkPSJwYXRoMTAiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cG9seWdvbgogICAgIGNsYXNzPSJzdDAiCiAgICAgcG9pbnRzPSI3My4yMSwxMzcuNTEgNzAuMzcsMTM3LjUxIDcwLjM3LDE1My40IDU2LjI3LDEzNy41MSA1My44NSwxMzcuNTEgNTMuODUsMTU3Ljk5IDU2LjY3LDE1Ny45OSA1Ni42NywxNDIuMjMgNzAuNjQsMTU3Ljk5IDczLjIxLDE1Ny45OSAiCiAgICAgaWQ9InBvbHlnb24xMiIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwb2x5Z29uCiAgICAgY2xhc3M9InN0MCIKICAgICBwb2ludHM9Ijk1LjI3LDE0Mi4wNSAxMDEuNzcsMTQ5Ljk4IDEwMi4zMiwxNDkuOTggMTA4Ljc1LDE0Mi4wNSAxMDguNzUsMTU3Ljk5IDExMS43NSwxNTcuOTkgMTExLjc1LDEzNy41MSAxMDguOTcsMTM3LjUxIDEwMi4wNCwxNDUuOTIgOTUuMDksMTM3LjUxIDkyLjI3LDEzNy41MSA5Mi4yNywxNTcuOTkgOTUuMjcsMTU3Ljk5ICIKICAgICBpZD0icG9seWdvbjE0IgogICAgIHN0eWxlPSJmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjEiIC8+PHJlY3QKICAgICB4PSIxMjAuMDkiCiAgICAgeT0iMTM3LjUwOTk5IgogICAgIGNsYXNzPSJzdDAiCiAgICAgd2lkdGg9IjMiCiAgICAgaGVpZ2h0PSIyMC40OCIKICAgICBpZD0icmVjdDE2IgogICAgIHN0eWxlPSJmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjEiIC8+PHBhdGgKICAgICBjbGFzcz0ic3QwIgogICAgIGQ9Im0gMTQxLjY2LDE1MC41MiBoIDQuMDEgdiA0LjI2IGMgLTEuOTksMC42MyAtMy4wMywwLjkgLTQuNTYsMC45IC01LjA1LDAgLTguMzksLTMuMzkgLTguMzksLTcuOTMgMCwtNC44NCAzLjk1LC03LjkgOC4xMiwtNy45IDEuMTYsMCAzLjk4LDAuMTggNy40MSwyLjEzIHYgLTMgYyAtMi4yNCwtMC45MyAtNC40MSwtMS43NCAtNy4zNSwtMS43NCAtNy4xNywwIC0xMS4zLDUuMjkgLTExLjMsMTAuNjkgMCw0LjY1IDMuMzQsMTAuMzMgMTEuNDMsMTAuMzMgMy40OSwwIDYuMDcsLTAuOTkgNy42NiwtMS42OCB2IC04LjY1IGggLTcuMDIgdiAyLjU5IHoiCiAgICAgaWQ9InBhdGgxOCIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwYXRoCiAgICAgY2xhc3M9InN0MCIKICAgICBkPSJtIDE2My43MSwxNDYuMTYgYyAtMC44MywwLjMgLTIuNDUsMC4zIC0yLjkxLDAuMyBoIC0xLjE2IFYgMTQwIGggMC45MiBjIDEuODEsMCAyLjc5LDAuMTIgMy41NSwwLjQ4IDAuOTgsMC40NSAxLjU5LDEuNTYgMS41OSwyLjczIDAuMDEsMS4xMiAtMC41OCwyLjQxIC0xLjk5LDIuOTUgbSAxLjU3LDIuMSBjIDIuMjcsLTAuODcgMy40OSwtMi42NyAzLjQ5LC01LjA1IDAsLTIuMDcgLTEuMDQsLTQuMTEgLTMuMjgsLTUuMDUgLTEuMzIsLTAuNTcgLTIuNiwtMC42NiAtMy41OCwtMC42NiBoIC01LjI0IHYgMjAuNDggaCAyLjk3IHYgLTguOTIgaCAwLjggYyAxLjQ0LDAgMi40NSwwIDQuNSwyLjU4IDAuNjcsMC44NyAzLjU4LDUuMzUgNC4yOSw2LjM0IGggMy41NSBjIC0xLjQ0LC0xLjk4IC0xLjk2LC0yLjY3IC0yLjg1LC00LjA4IC0xLjU5LC0yLjUxIC0yLjc1LC00LjQxIC00LjY1LC01LjY0IgogICAgIGlkPSJwYXRoMjAiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cGF0aAogICAgIGNsYXNzPSJzdDAiCiAgICAgZD0ibSAxODIuODksMTQ5LjMxIDMuMTIsLTcuNDIgMy4zNyw3LjQyIHogbSAyLjEyLC0xMS45MiAtOC45OCwyMC42IGggMy4wNiBsIDIuNjMsLTYuMDQgaCA4Ljg4IGwgMi43OSw2LjA0IGggMy4wNiBsIC05LjM0LC0yMC42IHoiCiAgICAgaWQ9InBhdGgyMiIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwb2x5Z29uCiAgICAgY2xhc3M9InN0MCIKICAgICBwb2ludHM9IjIwNC43NSwxNTcuOTkgMjA3Ljc1LDE1Ny45OSAyMDcuNzUsMTQwLjA5IDIxNS4wNCwxNDAuMDkgMjE1LjA0LDEzNy41MSAxOTcuNTgsMTM3LjUxIDE5Ny41OCwxNDAuMDkgMjA0Ljc1LDE0MC4wOSAiCiAgICAgaWQ9InBvbHlnb24yNCIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxyZWN0CiAgICAgeD0iMjIxLjYzIgogICAgIHk9IjEzNy41MDk5OSIKICAgICBjbGFzcz0ic3QwIgogICAgIHdpZHRoPSIzIgogICAgIGhlaWdodD0iMjAuNDgiCiAgICAgaWQ9InJlY3QyNiIKICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxIiAvPjxwYXRoCiAgICAgY2xhc3M9InN0MCIKICAgICBkPSJtIDI0OC4xNiwxNTMuMSBjIC0xLjQ0LDEuNTMgLTMuODYsMi40MyAtNi4xLDIuNDMgLTQuMzgsMCAtOC4xMiwtMy4wNiAtOC4xMiwtNy43MiAwLC0zLjQyIDIuMzYsLTcuODEgOC4yMSwtNy44MSA1LjQ1LDAgOC4wOSw0LjMgOC4wOSw3LjY5IDAsMS43OCAtMC43Nyw0IC0yLjA4LDUuNDEgbSAtNi4xMywtMTUuODYgYyAtNy4xNCwwIC0xMS4xOCw1LjE0IC0xMS4xOCwxMC41NyAwLDUuNzEgNC40NywxMC40NSAxMS4wMywxMC40NSA2LjgzLDAgMTEuNDMsLTQuNjYgMTEuNDMsLTEwLjU0IC0wLjAxLC01LjQ5IC00LjMzLC0xMC40OCAtMTEuMjgsLTEwLjQ4IgogICAgIGlkPSJwYXRoMjgiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cG9seWdvbgogICAgIGNsYXNzPSJzdDAiCiAgICAgcG9pbnRzPSIyNzguNDIsMTM3LjUxIDI3NS41NywxMzcuNTEgMjc1LjU3LDE1My40IDI2MS40OCwxMzcuNTEgMjU5LjA2LDEzNy41MSAyNTkuMDYsMTU3Ljk5IDI2MS44OCwxNTcuOTkgMjYxLjg4LDE0Mi4yMyAyNzUuODUsMTU3Ljk5IDI3OC40MiwxNTcuOTkgIgogICAgIGlkPSJwb2x5Z29uMzAiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cGF0aAogICAgIGNsYXNzPSJzdDAiCiAgICAgZD0ibSA1OS41Nyw4OS4zMyBjIDAuNjksMCAxLjI1LC0wLjU2IDEuMjUsLTEuMjUgMCwtMC42OSAtMC41NiwtMS4yNSAtMS4yNSwtMS4yNSAtMC42OSwwIC0xLjI1LDAuNTYgLTEuMjUsMS4yNSAwLDAuNjkgMC41NiwxLjI1IDEuMjUsMS4yNSIKICAgICBpZD0icGF0aDMyIgogICAgIHN0eWxlPSJmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjEiIC8+PHBhdGgKICAgICBjbGFzcz0ic3QwIgogICAgIGQ9Im0gNTQuODMsOTYuODQgYyAwLjA5LDAuMDYgMC4xOSwwLjA4IDAuMjgsMC4wOCAwLjIxLDAgMC40MSwtMC4xMiAwLjQ5LC0wLjMzIGwgMi4yMywtNS4yNSAwLjE3LDUuMTEgLTAuODQsNi40OCBjIC0wLjAzLDAuMjUgMC4xLDAuNTEgMC4zNSwwLjU5IDAuMDYsMC4wMiAwLjEyLDAuMDMgMC4xOSwwLjAzIDAuMjcsMCAwLjUsLTAuMiAwLjUzLC0wLjQ3IGwgMC44LC02LjE3IGggMS4wOCBsIDAuOCw2LjE3IGMgMC4wMywwLjI3IDAuMjcsMC40NyAwLjUzLDAuNDcgMC4wNiwwIDAuMTIsLTAuMDEgMC4xOSwtMC4wMyAwLjI0LC0wLjA5IDAuMzcsLTAuMzQgMC4zNSwtMC41OSBsIC0wLjg0LC02LjQ4IDAuMTYsLTUuMTEgMi4yMyw1LjI1IGMgMCwwIDAsMCAwLDAgMC4wMSwwLjAzIDAuMDMsMC4wNiAwLjA0LDAuMDggMCwwLjAxIDAuMDEsMC4wMSAwLjAyLDAuMDIgMC4wMSwwLjAyIDAuMDMsMC4wNCAwLjA0LDAuMDYgMC4wMSwwLjAxIDAuMDEsMC4wMSAwLjAyLDAuMDIgMC4wMiwwLjAyIDAuMDQsMC4wNCAwLjA2LDAuMDUgMCwwIDAuMDEsMC4wMSAwLjAxLDAuMDEgMC4wMywwLjAyIDAuMDUsMC4wMyAwLjA4LDAuMDQgMC4wMSwwIDAuMDIsMCAwLjAyLDAuMDEgMC4wMiwwLjAxIDAuMDQsMC4wMiAwLjA3LDAuMDIgMC4wMSwwIDAuMDIsMCAwLjAzLDAuMDEgMC4wMywwLjAxIDAuMDYsMC4wMSAwLjEsMC4wMSAwLDAgMCwwIDAsMCBoIDAuNDUgbCAtMC43MiwzLjY1IGMgLTAuMDUsMC4yNiAwLjAyLDAuNTMgMC4xOCwwLjczIDAuMSwwLjEzIDAuMjQsMC4yMiAwLjM5LDAuMjcgdiAxLjU0IGMgMCwwLjI1IDAuMiwwLjQ1IDAuNDUsMC40NSAwLjI1LDAgMC40NSwtMC4yIDAuNDUsLTAuNDUgdiAtMS40OSAwIGMgMC4wMiwwIDAuMDMsMCAwLjA0LDAgaCAwLjI5IDAuMjkgdiAwIGMgMC4wMiwwIDAuMDMsMCAwLjA0LDAgdiAwIDEuNDkgYyAwLDAuMjUgMC4yLDAuNDUgMC40NSwwLjQ1IDAuMjUsMCAwLjQ1LC0wLjIgMC40NSwtMC40NSB2IC0xLjU1IGMgMC4xNSwtMC4wNSAwLjI5LC0wLjE1IDAuMzksLTAuMjcgMC4xNywtMC4yMSAwLjI0LC0wLjQ3IDAuMTgsLTAuNzMgbCAtMC43MiwtMy42NCBoIDAuNDUgdiAwIGMgMC4wMywwIDAuMDYsMCAwLjEsLTAuMDEgMC4wMSwwIDAuMDIsMCAwLjAzLC0wLjAxIDAuMDIsMCAwLjA1LC0wLjAxIDAuMDcsLTAuMDIgMC4wMSwwIDAuMDIsLTAuMDEgMC4wMiwtMC4wMSAwLjAzLC0wLjAxIDAuMDYsLTAuMDMgMC4wOCwtMC4wNCAwLDAgMC4wMSwtMC4wMSAwLjAxLC0wLjAxIDAuMDIsLTAuMDEgMC4wNCwtMC4wMyAwLjA2LC0wLjA1IDAuMDEsLTAuMDEgMC4wMSwtMC4wMSAwLjAyLC0wLjAyIDAuMDIsLTAuMDIgMC4wMywtMC4wNCAwLjA0LC0wLjA2IDAsLTAuMDEgMC4wMSwtMC4wMSAwLjAyLC0wLjAyIDAuMDIsLTAuMDMgMC4wMywtMC4wNSAwLjA0LC0wLjA4IDAsMCAwLDAgMCwwIGwgMi4zMSwtNS40NCAwLjQ1LDIuMjEgYyAwLjA3LDAuMzYgMC4wNiwwLjc0IC0wLjAzLDEuMTEgbCAtMi4xMSw5LjA5IGggMi45MSAwLjc0IDIuOTEgbCAtMi4xMSwtOS4xIGMgLTAuMDksLTAuMzUgLTAuMSwtMC43MyAtMC4wMywtMS4wOSBsIDAuNDYsLTIuMjMgMS43OCw0LjM4IGMgMC4wOCwwLjIxIDAuMjksMC4zNCAwLjUsMC4zNCAwLjA3LDAgMC4xNCwtMC4wMSAwLjIsLTAuMDQgMC4yNywtMC4xMSAwLjQxLC0wLjQzIDAuMywtMC43IGwgLTIsLTQuOSBjIC0wLjA4LC0wLjIgLTAuMjgsLTAuMzQgLTAuNSwtMC4zNCBoIC0wLjAzIC0wLjg3IC0wLjYyIC0wLjc0IC0wLjYgLTAuODkgLTAuMDEgYyAtMC4yMiwwIC0wLjQxLDAuMTMgLTAuNDksMC4zMyBsIC0yLjQsNS42NSBoIC0yLjM3IGwgLTIuNCwtNS42NSBjIC0wLjA4LC0wLjIgLTAuMjgsLTAuMzMgLTAuNSwtMC4zMyBoIC0xLjkyIC0xLjkyIGMgLTAuMjIsMCAtMC40MSwwLjEzIC0wLjQ5LDAuMzMgbCAtMi41Myw1Ljk1IGMgLTAuMDUsMC4yNCAwLjAzLDAuNTQgMC4yNiwwLjY4IgogICAgIGlkPSJwYXRoMzQiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cGF0aAogICAgIGNsYXNzPSJzdDAiCiAgICAgZD0ibSA3MS41LDg5LjMzIGMgMC42OSwwIDEuMjUsLTAuNTYgMS4yNSwtMS4yNSAwLC0wLjY5IC0wLjU2LC0xLjI1IC0xLjI1LC0xLjI1IC0wLjY5LDAgLTEuMjUsMC41NiAtMS4yNSwxLjI1IDAsMC42OSAwLjU2LDEuMjUgMS4yNSwxLjI1IgogICAgIGlkPSJwYXRoMzYiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48cGF0aAogICAgIGNsYXNzPSJzdDAiCiAgICAgZD0ibSA2NS41Niw5NS41NyBjIDAuNTIsMCAwLjk0LC0wLjQyIDAuOTQsLTAuOTQgMCwtMC41MiAtMC40MiwtMC45NCAtMC45NCwtMC45NCAtMC41MiwwIC0wLjk0LDAuNDIgLTAuOTQsMC45NCAwLDAuNTIgMC40MiwwLjk0IDAuOTQsMC45NCIKICAgICBpZD0icGF0aDM4IgogICAgIHN0eWxlPSJmaWxsOiNmZmZmZmY7ZmlsbC1vcGFjaXR5OjEiIC8+PHBhdGgKICAgICBjbGFzcz0ic3QwIgogICAgIGQ9Im0gNzEuMjUsMTEyLjMxIGMgLTIuMjYsMC4xMiAtNC40LDAuNjMgLTYuMzgsMS40NSAtMi45MSwtMS4yOCAtNS42NSwtMy40OCAtNy43MiwtNi4yNCBoIDE0LjEgeiBtIDAsOS4yNSBjIC0zLjg4LC0wLjIgLTcuNTQsLTEuMjggLTEwLjgsLTMuMDcgMi44MywtMi42MyA2LjYxLC00LjMyIDEwLjgsLTQuNTggeiBNIDQ5LjY0LDEwNy41MiBoIDUuNDUgYyAyLjA1LDMuMDcgNC44MSw1LjYgNy43Nyw3LjIyIC0xLjQzLDAuOCAtMi43MywxLjc3IC0zLjg4LDIuODkgLTMuODcsLTIuNDcgLTcuMDksLTUuOTYgLTkuMzQsLTEwLjExIE0gNDYuMjksOTYuNDkgaCA1LjMyIGMgMCwwLjA1IDAsMC4xIDAsMC4xMyAwLDMuMTcgMC44OCw2LjI0IDIuMzQsOC45OCBIIDQ4LjcgYyAtMS4yNywtMi44IC0yLjEsLTUuODcgLTIuNDEsLTkuMTEgbSAtNy4xOCwtMS45MSBjIC0wLjAxLC0wLjI0IC0wLjAyLC0wLjYxIC0wLjAyLC0wLjgyIDAsLTMuMiAwLjk3LC02LjI5IDIuNTcsLTguOTggaCAzMi45OCBjIDEuNTksMi42OSAyLjU3LDUuNzggMi41Nyw4Ljk4IDAsMC4wNCAwLDAuMDggMCwwLjEzIGggLTAuMDIgbCAtMC4wMywxLjkxIGggMTQuMjMgYyAwLDAuMjQgMC4wMSwwLjYxIDAuMDEsMC44MiAwLDMuMiAtMC45Nyw2LjI5IC0yLjU3LDguOTggSCA1NS44NyBjIC0xLjU5LC0yLjY5IC0yLjU2LC01Ljc4IC0yLjU2LC04Ljk4IDAsLTAuMDQgMCwtMC4wOCAwLC0wLjEzIHYgMCBsIDAuMDMsLTEuOTEgeiBtIC03LjQyLDAgYyAwLjI2LC0zLjQ4IDEuMTIsLTYuNzkgMi40NiwtOS44IGggNS42IGMgLTEuNDYsMi43NCAtMi4zNCw1LjgxIC0yLjM0LDguOTggMCwwLjE1IDAsMC41NSAwLjAxLDAuODIgeiBNIDQ0LjY2LDcyLjY0IGMgMS4xOCwxLjE3IDIuNTMsMi4xOSA0LjAxLDMuMDIgLTIuOTYsMS42MiAtNS43Miw0LjE1IC03Ljc3LDcuMjIgaCAtNS44IGMgMi4yOSwtNC4yNCA1LjU5LC03Ljc3IDkuNTYsLTEwLjI0IG0gMTIuNjcsNS40NiB2IDQuNzggSCA0Mi45NSBjIDIuMDgsLTIuNzYgNC44MiwtNC45NiA3LjczLC02LjI0IDIuMDUsMC44NSA0LjI5LDEuMzYgNi42NSwxLjQ2IG0gMCwtOS4yOCB2IDcuNjggYyAtNC4zNiwtMC4yIC04LjMsLTEuOTYgLTExLjE5LC00LjcxIDMuMzcsLTEuODEgNy4xNywtMi44NyAxMS4xOSwtMi45NyBtIDEuOTIsOS4yNyBjIDIuMjYsLTAuMTIgNC40LC0wLjYzIDYuMzgsLTEuNDUgMi45MSwxLjI4IDUuNjUsMy40OCA3LjczLDYuMjQgSCA1OS4yNSBaIG0gMCwtOS4yNSBjIDMuODgsMC4yIDcuNTMsMS4yOCAxMC44LDMuMDcgLTIuODIsMi42MiAtNi42LDQuMzIgLTEwLjgsNC41NyB6IE0gODAuODYsODIuODggSCA3NS40IGMgLTIuMDQsLTMuMDcgLTQuOCwtNS42IC03Ljc3LC03LjIyIDEuNDIsLTAuOCAyLjczLC0xLjc3IDMuODgsLTIuODkgMy44OCwyLjQ3IDcuMSw1Ljk1IDkuMzUsMTAuMTEgbSAzLjM1LDExLjAyIGggLTUuMzIgYyAwLC0wLjA1IDAsLTAuMSAwLC0wLjEzIDAsLTMuMTcgLTAuODgsLTYuMjQgLTIuMzQsLTguOTggaCA1LjI1IGMgMS4yNywyLjgxIDIuMSw1Ljg4IDIuNDEsOS4xMSBtIDE0LjYsMS45MSBjIC0wLjI2LDMuNDggLTEuMTIsNi43OSAtMi40Niw5LjggaCAtNS42IGMgMS40NiwtMi43NCAyLjM0LC01LjgxIDIuMzQsLTguOTggMCwtMC4xNiAwLC0wLjU1IC0wLjAxLC0wLjgyIHogbSAtMTIuOTcsMjEuOTQgYyAtMS4xOCwtMS4xNyAtMi41MywtMi4xOSAtNC4wMSwtMy4wMiAyLjk2LC0xLjYyIDUuNzIsLTQuMTUgNy43NywtNy4yMiBoIDUuOCBjIC0yLjI5LDQuMjQgLTUuNTksNy43NyAtOS41NiwxMC4yNCBtIC0xMi42NywtNS40NiB2IC00Ljc4IGggMTQuMzggYyAtMi4wOCwyLjc2IC00LjgyLDQuOTYgLTcuNzMsNi4yNCAtMi4wNSwtMC44NSAtNC4yOSwtMS4zNiAtNi42NSwtMS40NiBtIDAsOS4yOSB2IC03LjY4IGMgNC4zNiwwLjIgOC4yOSwxLjk2IDExLjE5LDQuNzEgLTMuMzcsMS44MSAtNy4xNywyLjg2IC0xMS4xOSwyLjk3IG0gMjkuOTksLTI4LjI1IGMgMCwtOS43NiAtNC40NywtMjAuNjggLTExLjc1LC0yOC44MSBoIC02LjQ5IGMgMS43LDEuNTYgNC4wNiw0LjI5IDQuMDYsNC4yOSA2LjI2LDcgOS45MSwxNi4zOSA5LjkxLDI0Ljc4IDAsMC4xIDAsMC4yMSAwLDAuMzEgSCA4OC41IEMgODYuOTIsNzcuNSA3My44Niw2NC41MiA1Ny45OSw2NC41MiBjIC0xNi45MywwIC0zMC42NiwxNC41NyAtMzAuNjYsMzIuNTUgMCw5Ljc2IDQuNDgsMjAuNjggMTEuNzUsMjguODEgaCA2LjQ5IGMgLTEuNjksLTEuNTYgLTQuMDYsLTQuMjkgLTQuMDYsLTQuMjkgLTYuMjYsLTcgLTkuOTEsLTE2LjM5IC05LjkxLC0yNC43OCAwLC0wLjEgMCwtMC4yMSAwLC0wLjMxIEggNDIgYyAxLjU4LDE2LjQgMTQuNjUsMjkuMzggMzAuNTEsMjkuMzggMTYuOTMsMCAzMC42NSwtMTQuNTcgMzAuNjUsLTMyLjU1IgogICAgIGlkPSJwYXRoNDAiCiAgICAgc3R5bGU9ImZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MSIgLz48L2c+PC9zdmc+Cg==" alt="IOM Logo" class="img-fluid" style="max-height: 2.5rem">

    </a>

  </div>

</div>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="index_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>